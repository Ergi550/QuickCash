<div class="menu-container">
  <div class="container">
    <!-- Header -->
    <div class="menu-header">
      <h1>Our Menu</h1>
      <p>Choose your favorite items</p>
    </div>

    <!-- Category Filter - Dynamic from Database -->
    <div class="category-filter">
      <button 
        class="category-btn"
        [class.active]="selectedCategoryId === null"
        (click)="filterByCategory(null)"
      >
        üçΩÔ∏è All
      </button>
      
      <!-- Dynamic categories from API -->
      <button 
        *ngFor="let category of categories"
        class="category-btn"
        [class.active]="selectedCategoryId === category.category_id"
        (click)="filterByCategory(category.category_id)"
      >
        <span *ngIf="category.icon">{{ category.icon }}</span>
        {{ category.category_name }}
      </button>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading">
      <div class="spinner"></div>
      <p>Loading menu...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="errorMessage" class="alert alert-error">
      {{ errorMessage }}
    </div>

    <!-- Products Grid -->
    <div *ngIf="!isLoading && !errorMessage" class="products-grid">
      <div *ngFor="let product of filteredProducts" class="product-card">
        <div class="product-image">
  <img 
    *ngIf="product.image_url; else noImage"
    [src]="product.image_url" 
    [alt]="product.product_name"
    (error)="onImageError($event)"
  />
  <ng-template #noImage>
  </ng-template>
  
  <span class="badge featured" *ngIf="product.is_featured">‚≠ê</span>
  <span class="badge out-of-stock" *ngIf="!product.is_available">Out of Stock</span>
          <span class="badge category" *ngIf="product.category_name">
            {{ product.category_name }}
          </span>
        </div>

        <div class="product-info">
          <h3 class="product-name">{{ product.product_name }}</h3>
          <p class="product-description">{{ product.description }}</p>
          
          <div class="product-footer">
            <div class="product-price">
              {{ product.selling_price | number:'1.0-0' }} ALL
            </div>
            
            <div class="product-actions">
              <div class="quantity-selector" *ngIf="getProductQuantity(product.product_id) > 0">
                <button class="qty-btn" (click)="decreaseQuantity(product)">-</button>
                <span class="qty-display">{{ getProductQuantity(product.product_id) }}</span>
                <button 
                  class="qty-btn"
                  (click)="increaseQuantity(product)"
                  [disabled]="!product.is_available"
                >+</button>
              </div>
              
              <button 
                *ngIf="getProductQuantity(product.product_id) === 0"
                class="btn btn-primary"
                (click)="addToCart(product)"
                [disabled]="!product.is_available"
              >
                Add to Cart
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && filteredProducts.length === 0" class="empty-state">
      <h3>No products found</h3>
      <p>Try selecting a different category</p>
    </div>
  </div>
</div>

